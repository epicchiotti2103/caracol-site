<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caracol Media - Especialistas em Growth Marketing e Job Advertising</title>
    <meta name="description" content="Especialistas em m√≠dia paga para canais n√£o convencionais. Escalamos neg√≥cios com tecnologia propriet√°ria e expertise em toda Am√©rica Latina.">
    <link rel="stylesheet" href="../css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
  <div class="container">
    <div class="nav-brand">
  <a href="#">
    <img src="../images/logo-caracol-secundario-negativo.png" alt="Caracol Media" style="max-width: 140px; height: auto;">
  </a>
</div>


  <!-- Idiomas alinhados -->
<div class="nav-menu" id="nav-menu">
  <a href="#hero" class="nav-link">In√≠cio</a>
  <a href="#core-business" class="nav-link">Servi√ßos</a>
  <a href="#diferenciais" class="nav-link">Diferenciais</a>
  <a href="#cases" class="nav-link">Cases</a>
  <a href="../blog/pt/index.html" class="nav-link">Conte√∫do</a>
  <a href="#contato" class="nav-link">Contato</a>
  <a href="../publisher/pt/index.html" class="nav-link" target="_blank" rel="noopener">
    Seja um Publisher
  </a>
  <div class="language-selector">
    <a href="#" id="current-language">
      <img src="https://flagcdn.com/br.svg" alt="Portugu√™s" class="flag-icon" />
      <span>PT-BR</span>
      <i class="fas fa-chevron-down" style="font-size: 0.8em; margin-left: 0.3em;"></i>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="/pt/">
          <img src="https://flagcdn.com/br.svg" alt="Portugu√™s" class="flag-icon" />
          <span>PT-BR</span>
        </a>
      </li>
      <li>
        <a href="/en/">
          <img src="https://flagcdn.com/us.svg" alt="English" class="flag-icon" />
          <span>EN</span>
        </a>
      </li>
      <li>
        <a href="/es/">
          <img src="https://flagcdn.com/es.svg" alt="Espa√±ol" class="flag-icon" />
          <span>ES</span>
        </a>
      </li>
      <li>
        <a href="/ch/">
          <img src="https://flagcdn.com/cn.svg" alt="Chinese" class="flag-icon" />
          <span>CN</span>
        </a>
      </li>
    </ul>
  </div>
</nav>


<!-- =========================
     FORMUL√ÅRIO ‚Äî Caracol
========================= -->
<section id="formulario" class="formulario">
  <div class="container">
    <div class="section-header">
      <span class="core-badge core-badge-yellow"><i class="fa-solid fa-pen-to-square"></i> Formul√°rio de Inscri√ß√£o</span>
      <h2>Vamos te conhecer</h2>
      <p class="subtitle">Leva ~5 min e voc√™ pode salvar rascunho automaticamente neste navegador.</p>
    </div>

    <!-- Progress -->
    <div class="wizard-progress" aria-hidden="true">
      <div class="wizard-progress-bar"><span id="wizardProgressFill" style="width: 10%"></span></div>
      <div class="wizard-steps">
        <span class="dot active">1</span><span class="dot">2</span><span class="dot">3</span><span class="dot">4</span><span class="dot">5</span>
      </div>
    </div>

    <form id="caracolForm" novalidate>
      <!-- ========== STEP 1: Dados Pessoais ========== -->
      <fieldset class="form-step current" data-step="1" aria-label="Dados pessoais">
        <legend>Vamos te conhecer</legend>

        <div class="grid-2">
          <div class="field">
            <label for="nomePreferido">Como voc√™ quer ser chamado? <span class="req">*</span></label>
            <input type="text" id="nomePreferido" name="nomePreferido" required placeholder="Ex.: Ana, Jo√£o, Lio" />
            <small class="hint">Nome preferido para comunica√ß√£o.</small>
          </div>

          <div class="field">
            <label for="email">E-mail <span class="req">*</span></label>
            <input type="email" id="email" name="email" required placeholder="voce@exemplo.com" />
          </div>
        </div>

        <div class="grid-2">
          <div class="field">
            <label for="cidadeEstado">Cidade / Estado <span class="req">*</span></label>
            <input type="text" id="cidadeEstado" name="cidadeEstado" required placeholder="Botucatu/SP" />
          </div>
          <div class="field">
            <label for="linkedin">LinkedIn ou outra rede profissional</label>
            <input type="url" id="linkedin" name="linkedin" placeholder="https://linkedin.com/in/seuusuario" />
          </div>
        </div>

        <div class="grid-2">
          <div class="field">
            <label for="curso">Curso / Universidade <span class="req">*</span></label>
            <input type="text" id="curso" name="curso" required placeholder="Eng. Produ√ß√£o ‚Äî UNESP" />
          </div>

          <div class="field">
            <label for="cv">Upload do seu CV (PDF, m√°x. 10MB) <span class="req">*</span></label>
            <input type="file" id="cv" name="cv" required accept="application/pdf" />
            <small class="hint" id="cvStatus">Anexe seu PDF. Tamanho m√°ximo: 10MB.</small>
          </div>
        </div>

        <div class="wizard-nav">
          <button type="button" class="btn btn-primary next">Pr√≥ximo</button>
        </div>
      </fieldset>

      <!-- ========== STEP 2: Idiomas ========== -->
      <fieldset class="form-step" data-step="2" aria-label="Idiomas">
        <legend>Idiomas</legend>

        <div class="field">
          <label>Qual seu n√≠vel de ingl√™s? <span class="req">*</span></label>
          <div class="choices choices-columns">
            <label><input type="radio" name="ingles" value="Iniciante" required> Iniciante</label>
            <label><input type="radio" name="ingles" value="Intermedi√°rio"> Intermedi√°rio</label>
            <label><input type="radio" name="ingles" value="Avan√ßado"> Avan√ßado</label>
            <label><input type="radio" name="ingles" value="Fluente"> Fluente</label>
          </div>
        </div>

        <div class="field">
          <label>Voc√™ fala espanhol?</label>
          <div class="choices choices-columns">
            <label><input type="radio" name="espanhol" value="N√£o" checked> N√£o</label>
            <label><input type="radio" name="espanhol" value="N√£o" checked> Iniciante</label>
            <label><input type="radio" name="espanhol" value="Intermedi√°rio"> Intermedi√°rio</label>
            <label><input type="radio" name="espanhol" value="Avan√ßado"> Avan√ßado</label>
          </div>
        </div>

        <div class="field">
          <label for="outrosIdiomas">Outros idiomas?</label>
          <input type="text" id="outrosIdiomas" name="outrosIdiomas" placeholder="Ex.: Franc√™s b√°sico" />
        </div>

        <div class="wizard-nav">
          <button type="button" class="btn btn-secondary prev">Voltar</button>
          <button type="button" class="btn btn-primary next">Pr√≥ximo</button>
        </div>
      </fieldset>

      <!-- ========== STEP 3: Experi√™ncias & Habilidades ========== -->
      <fieldset class="form-step" data-step="3" aria-label="Experi√™ncias">
        <legend>Experi√™ncias</legend>

        <div class="field">
          <label for="experiencia">Voc√™ tem alguma experi√™ncia profissional? Se sim, conte um pouco.</label>
          <textarea id="experiencia" name="experiencia" rows="4" placeholder="Est√°gio, projetos, empresa j√∫nior, freela..."></textarea>
        </div>

        <div class="field">
          <label>Marque as habilidades que voc√™ j√° tem (ou est√° aprendendo):</label>
          <div class="choices choices-grid">
            <label><input type="checkbox" name="skills" value="Excel / Google Sheets"> Excel / Google Sheets</label>
            <label><input type="checkbox" name="skills" value="An√°lise de dados"> An√°lise de dados</label>
            <label><input type="checkbox" name="skills" value="Copywriting / Escrita criativa"> Copywriting / Escrita criativa</label>
            <label><input type="checkbox" name="skills" value="Design / Social media"> Design / Social media</label>
            <label><input type="checkbox" name="skills" value="Prospec√ß√£o B2B"> Prospec√ß√£o B2B (Apollo, HubSpot, LinkedIn)</label>
            <label><input type="checkbox" name="skills" value="AI (ChatGPT, Claude, Manus, etc)"> AI (ChatGPT, Claude, Manus, etc)</label>
            <label><input type="checkbox" name="skills" value="Vendas / Reuni√µes Comerciais"> Vendas / Reuni√µes Comerciais</label>
            <label><input type="checkbox" name="skills" value="Atendimento ao cliente"> Atendimento ao cliente</label>
            <label><input type="checkbox" name="skills" value="Produ√ß√£o de conte√∫dos"> Produ√ß√£o de conte√∫dos para Blogs e sites</label>
            <label class="span-2">
              <span>Outros:</span>
              <input type="text" name="skills_outros" placeholder="Liste outras habilidades" />
            </label>
          </div>
        </div>

        <div class="grid-2">
          <div class="field">
            <label for="motivacaoCurso">O que te motivou a escolher (e continuar) seu curso de gradua√ß√£o?</label>
            <textarea id="motivacaoCurso" name="motivacaoCurso" rows="3"></textarea>
          </div>
          <div class="field">
            <label for="habilidadesAprender">Habilidades que voc√™ quer aprender com os s√≥cios da Caracol</label>
            <textarea id="habilidadesAprender" name="habilidadesAprender" rows="3"></textarea>
          </div>
        </div>

        <div class="wizard-nav">
          <button type="button" class="btn btn-secondary prev">Voltar</button>
          <button type="button" class="btn btn-primary next">Pr√≥ximo</button>
        </div>
      </fieldset>

      <!-- ========== STEP 4: Trilha ========== -->
      <fieldset class="form-step" data-step="4" aria-label="Trilha">
        <legend>Escolha sua trilha</legend>

        <div class="field">
          <label>Qual trilha voc√™ quer seguir? <span class="req">*</span></label>
          <div class="choices choices-cards">
            <label class="card-choice">
              <input type="radio" name="trilha" value="Vendas & Marketing" required />
              <div class="card">
                <i class="fa-solid fa-bullhorn"></i>
                <strong>Vendas &amp; Marketing</strong>
              </div>
            </label>

            <label class="card-choice">
              <input type="radio" name="trilha" value="Opera√ß√µes" />
              <div class="card">
                <i class="fa-solid fa-gears"></i>
                <strong>Opera√ß√µes</strong>
              </div>
            </label>

            <label class="card-choice">
              <input type="radio" name="trilha" value="Atendimento / M√≠dia" />
              <div class="card">
                <i class="fa-solid fa-headset"></i>
                <strong>Atendimento / M√≠dia</strong>
              </div>
            </label>
          </div>
        </div>

        <div class="wizard-nav">
          <button type="button" class="btn btn-secondary prev">Voltar</button>
          <button type="button" class="btn btn-primary next">Pr√≥ximo</button>
        </div>
      </fieldset>

      <!-- ========== STEP 5: Question√°rio de Cen√°rios ========== -->
      <fieldset class="form-step" data-step="5" aria-label="Question√°rio">
        <legend>Question√°rio</legend>
        <p class="subtitle">N√£o existe resposta perfeita. Queremos entender sua forma de pensar, agir e aprender.</p>

        <div class="carousel-container">
        <div class="qblock">
          <h4>1) Campanha global</h4>
          <p>Voc√™ recebe uma campanha para rodar com um cliente da √Åsia. O briefing chega em ingl√™s, cheio de termos t√©cnicos que voc√™ n√£o domina. O que faz?</p>
          <div class="choices">
            <label><input type="radio" name="q1" value="Traduzo e sigo" required> Jogo no tradutor e sigo em frente.</label>
            <label><input type="radio" name="q1" value="Pe√ßo ajuda ao time"> Pe√ßo ajuda ao time logo cedo.</label>
            <label><input type="radio" name="q1" value="Pesquiso sozinho"> Pesquiso sozinho at√© entender.</label>
            <label><input type="radio" name="q1" value="Respondo r√°pido ao cliente"> Respondo r√°pido para ganhar tempo.</label>
          </div>
        </div>

        <div class="qblock">
          <h4>2) Dados brutos</h4>
          <p>O publisher chin√™s te manda uma planilha com 30 mil linhas de dados. Qual seu primeiro passo?</p>
          <div class="choices">
            <label><input type="radio" name="q2" value="M√©tricas b√°sicas" required> Puxo CTR/CPA para checar sa√∫de.</label>
            <label><input type="radio" name="q2" value="Visualizo antes"> Crio filtros/gr√°ficos e visualizo.</label>
            <label><input type="radio" name="q2" value="Pergunto meta"> Pergunto qual √© a meta principal.</label>
            <label><input type="radio" name="q2" value="Confiro consist√™ncia"> Confiro se bate com relat√≥rios oficiais.</label>
          </div>
        </div>

        <div class="qblock">
          <h4>3) Cliente exigente</h4>
          <p>Em uma call, o cliente pressiona por resultados imediatos. Como voc√™ reage?</p>
          <div class="choices">
            <label><input type="radio" name="q3" value="Escuto e levo ao time" required> Escuto e levo para o time.</label>
            <label><input type="radio" name="q3" value="Respondo na hora"> Respondo na hora com o que j√° fazemos.</label>
            <label><input type="radio" name="q3" value="Alinho m√©tricas"> Pergunto as m√©tricas priorit√°rias.</label>
            <label><input type="radio" name="q3" value="Acalmo o cliente"> TENTO acalmar e mostrar processo.</label>
          </div>
        </div>

        <div class="qblock">
          <h4>4) Ritmo Caracol</h4>
        <p>Num dia comum surgem 3 reuni√µes internacionais, uma planilha gigante e uma campanha para revisar. O que te empolga mais nesse caos?</p>
          <div class="choices">
            <label><input type="radio" name="q4" value="Pessoas mundo todo" required> Conversar com gente do mundo todo.</label>
            <label><input type="radio" name="q4" value="Insights nos dados"> Descobrir insights nos dados.</label>
            <label><input type="radio" name="q4" value="Resolver r√°pido"> Resolver r√°pido e entregar resultado.</label>
            <label><input type="radio" name="q4" value="Organizar processos"> Organizar tudo e dar ordem ao processo.</label>
          </div>
        </div>

        <div class="qblock">
          <h4>5) Conte√∫do sem briefing</h4>
<p>Voc√™ precisa criar um post para LinkedIn sem orienta√ß√£o pr√©via. Qual sua abordagem?</p>
          <div class="choices">
            <label><input type="radio" name="q5" value="Cases globais" required> Ca√ßo refer√™ncias em cases globais.</label>
            <label><input type="radio" name="q5" value="Bench de mercado"> Analiso posts que performaram e adapto.</label>
            <label><input type="radio" name="q5" value="Ousado do zero"> Crio algo ousado para testar.</label>
            <label><input type="radio" name="q5" value="Alinho com lideran√ßa"> Pergunto √† lideran√ßa o foco.</label>
          </div>
        </div>

        <div class="qblock">
          <h4>6) Aprendizado r√°pido</h4>
<p>Voc√™ recebe uma ferramenta nova (ex.: HubSpot, Apollo). Como aprende?</p>
          <div class="choices">
            <label><input type="radio" name="q6" value="Tutoriais" required> Procuro tutoriais/manuais.</label>
            <label><input type="radio" name="q6" value="Pergunto ao time"> Pergunto a algu√©m do time.</label>
            <label><input type="radio" name="q6" value="Aprendo na pr√°tica"> Testo na pr√°tica.</label>
            <label><input type="radio" name="q6" value="Crio meu guia"> Organizo um guia passo a passo.</label>
          </div>
        </div>

        <div class="qblock">
          <h4>7) Erro descoberto</h4>
<p>Voc√™ encontra um erro numa campanha que ningu√©m notou. O que faz?</p>
          <div class="choices">
            <label><input type="radio" name="q7" value="Corrijo sozinho" required> Corrijo sozinho, sem alarde.</label>
            <label><input type="radio" name="q7" value="Comunico time"> Comunico o time.</label>
            <label><input type="radio" name="q7" value="Explico e proponho"> Explico o erro e proponho solu√ß√£o.</label>
            <label><input type="radio" name="q7" value="Espero"> Espero para ver se algu√©m percebe.</label>
          </div>
        </div>

        <div class="qblock">
          <h4>8) Prazo apertado</h4>
<p>Um cliente pede uma entrega em 24h, mas voc√™ j√° tem outras tarefas. Sua rea√ß√£o inicial √©:</p>
          <div class="choices">
            <label><input type="radio" name="q8" value="Renegocio" required> Tento renegociar prazos.</label>
            <label><input type="radio" name="q8" value="Ataco logo"> Ataco logo, mesmo sem estar perfeito.</label>
            <label><input type="radio" name="q8" value="Criatividade"> Busco solu√ß√£o criativa.</label>
            <label><input type="radio" name="q8" value="Pe√ßo ajuda"> Pe√ßo ajuda ao time.</label>
          </div>
        </div>

        <div class="qblock">
          <h4>9) Reuni√µes em ingl√™s</h4>
<p>Voc√™ entra em uma call internacional em ingl√™s e n√£o entende tudo. O que faz?</p>
          <div class="choices">
            <label><input type="radio" name="q9" value="Anoto e reviso" required> Anoto e reviso depois.</label>
            <label><input type="radio" name="q9" value="Pe√ßo para repetir"> Pe√ßo para repetirem.</label>
            <label><input type="radio" name="q9" value="Confirmo no chat"> Confirmo no chat.</label>
            <label><input type="radio" name="q9" value="Capto o essencial"> Capto o essencial e sigo.</label>
          </div>
        </div>

        <div class="qblock">
          <h4>10) Reflex√£o pessoal</h4>
          <p>Quando voc√™ imaginar olhar para tr√°s daqui a 1 ano de est√°gio na Caracol, o que gostaria de contar que viveu?</p>
          <div class="field">
            <textarea id="q10" name="q10" rows="4" placeholder="Resposta aberta"></textarea>
          </div>
        </div>
        </div>

        <div class="wizard-nav">
          <button type="button" class="btn btn-secondary prev">Voltar</button>
          <button type="submit" class="btn btn-primary submit">Enviar</button>
          <div id="status-envio" aria-live="polite" class="hint" style="margin-top:.5rem"></div>
        </div>
      </fieldset>

      <!-- ========== THANK YOU ========== -->
      <div id="thankyou" class="thankyou hidden" role="status" aria-live="polite">
        <div class="ty-card">
          <i class="fa-solid fa-circle-check"></i>
          <h3>Obrigado por se inscrever! üéâ</h3>
          <p>Agradecemos por ter chegado at√© aqui. Agora √© com a gente. Vamos revisar suas respostas e retornaremos o contato.</p>
          <a href="#topo" class="btn btn-secondary">Voltar ao in√≠cio</a>
        </div>
      </div>

    </form>
  </div>
</section>

<!-- ===== JS (inline) ===== -->
<script>
function randomFloat(min, max) {
  return Math.random() * (max - min) + min;
}

function animateCard(card) {
  const x = randomFloat(-30, 30);
  const y = randomFloat(-30, 30);
  card.style.transition = "transform 1.5s cubic-bezier(.4,2,.6,1)";
  card.style.transform = `translate(${x}px, ${y}px)`;
  setTimeout(() => animateCard(card), randomFloat(1200, 2200));
}

window.addEventListener('DOMContentLoaded', () => {
  const card1 = document.querySelector('.card-1');
  const card2 = document.querySelector('.card-2');
  if (card1) animateCard(card1);
  if (card2) animateCard(card2);
});
</script>

<script>
(function(){
  // ========== NAVEGA√á√ÉO PRINCIPAL DO FORMUL√ÅRIO ========== 
  const form = document.getElementById('caracolForm');
  const steps = Array.from(document.querySelectorAll('.form-step'));
  const dots = Array.from(document.querySelectorAll('.wizard-steps .dot'));
  const progressFill = document.getElementById('wizardProgressFill');
  const maxStep = steps.length;
  let current = 0; // index do step

  const btnNextAll = () => Array.from(document.querySelectorAll('.next'));
  const btnPrevAll = () => Array.from(document.querySelectorAll('.prev'));
  const btnSubmit  = () => form.querySelector('.submit');

  function refreshButtons(){
    const fieldset = steps[current];
    const stepNum = parseInt(fieldset.dataset.step, 10);

    // Submit s√≥ aparece no √∫ltimo passo; Next some no √∫ltimo passo
    const submitBtn = btnSubmit();
    btnNextAll().forEach(b => { if (stepNum === 5) b.classList.add('hidden'); else b.classList.remove('hidden'); });
    if (submitBtn) {
      if (stepNum === 5) { 
        // S√≥ mostra o bot√£o se todas as perguntas estiverem respondidas
        const allAnswered = validateQuestionario();
        if (allAnswered) {
          submitBtn.classList.add('show');
          submitBtn.disabled = false;
          submitBtn.textContent = 'Enviar';
          console.log('‚úÖ Bot√£o "Enviar" liberado - todas as perguntas respondidas');
        } else {
          submitBtn.classList.remove('show');
          console.log('‚è≥ Bot√£o "Enviar" oculto - faltam perguntas');
        }
      } else { 
        submitBtn.classList.remove('show'); 
      }
    }

    // Prev aparece a partir do passo 2
    btnPrevAll().forEach(b => { if (stepNum >= 2) b.classList.remove('hidden'); else b.classList.add('hidden'); });
  }

  // Fun√ß√£o para validar se todas as perguntas do question√°rio foram respondidas
  function validateQuestionario() {
    const step5 = form?.querySelector('fieldset[data-step="5"]');
    if (!step5) return false;

    // Verifica perguntas 1-9 (radio buttons)
    for (let i = 1; i <= 9; i++) {
      const checked = step5.querySelector(`input[name="q${i}"]:checked`);
      if (!checked) return false;
    }
    
    // Verifica pergunta 10 (textarea)
    const q10 = step5.querySelector('#q10');
    if (!q10 || !q10.value.trim()) return false;

    return true;
  }

  // Navega√ß√£o
  function updateStep(idx){
    steps.forEach((s, i) => s.classList.toggle('current', i === idx));
    dots.forEach((d, i) => d.classList.toggle('active', i <= idx));
    const pct = Math.max(10, Math.round(((idx + 1) / maxStep) * 100));
    progressFill.style.width = pct + '%';
    current = idx;
    steps[idx].scrollIntoView({behavior: 'smooth', block: 'start'});
    refreshButtons();

    // Se chegou no step 5, inicializa o carousel
    if (idx === 4) {
      setTimeout(() => ensureCarousel(), 200);
    }
  }

  function next(){
    if (!validateStep(current)) return;
    if (current < maxStep - 1) updateStep(current + 1);
  }

  function prev(){
    if (current > 0) updateStep(current - 1);
  }

  // Bloqueia Enter para enviar antes do √∫ltimo passo (exceto textarea)
  form.addEventListener('keydown', (e) => {
    const isEnter = (e.key === 'Enter' || e.keyCode === 13);
    const targetIsTextarea = e.target && e.target.tagName === 'TEXTAREA';
    const fieldset = steps[current];
    const stepNum = parseInt(fieldset.dataset.step, 10);
    if (isEnter && stepNum !== 5 && !targetIsTextarea) {
      e.preventDefault();
    }
  }, true);

  // Valida√ß√£o simples do step atual
  function validateStep(idx){
    const fieldset = steps[idx];
    if (fieldset.dataset.step === '5') {
      return true; // valida√ß√£o espec√≠fica no envio
    }
    const required = Array.from(fieldset.querySelectorAll('[required]'));
    let ok = true;
    required.forEach(el => {
      if (el.type === 'radio'){
        const group = fieldset.querySelectorAll(`input[name="${el.name}"]`);
        const anyChecked = Array.from(group).some(r => r.checked);
        if (!anyChecked){ ok = false; }
      } else if (el.type === 'file'){
        if (!el.files || !el.files[0]){ ok = false; }
      } else {
        if (!el.value.trim()){ ok = false; }
      }
    });
    return ok;
  }

  // Bot√µes de navega√ß√£o
  btnNextAll().forEach(b => b.addEventListener('click', next));
  btnPrevAll().forEach(b => b.addEventListener('click', prev));

  // ========== CAROUSEL DO STEP 5 ========== 
  function initQuestionCarousel(){
    const step5 = form?.querySelector('fieldset[data-step="5"]');
    if(!step5) return;

    const blocks = Array.from(step5.querySelectorAll('.qblock'));
    if (!blocks.length) return;

    let currentIndex = 0;

    function showQuestion(index) {
      if (index < 0 || index >= blocks.length) return;
      blocks.forEach((block, i) => {
        const isActive = i === index;
        block.classList.toggle('active', isActive);
        const radios = block.querySelectorAll('input[type="radio"]');
        const textarea = block.querySelector('textarea');
        radios.forEach(r => r.toggleAttribute('required', isActive));
        if (textarea) textarea.toggleAttribute('required', isActive);
      });
      currentIndex = index;
      updateCarouselIndicator();
    }

    function updateCarouselIndicator() {
      const container = step5.querySelector('.carousel-container');
      let indicator = container.querySelector('.carousel-indicator');
      if (!indicator) {
        indicator = document.createElement('div');
        indicator.className = 'carousel-indicator';
        indicator.style.cssText = `position:absolute;top:-10px;right:0;background:rgba(255,224,27,.2);color:#fff;padding:4px 8px;border-radius:12px;font-size:.8rem;font-weight:600;`;
        container.appendChild(indicator);
      }
      indicator.textContent = `${currentIndex + 1}/${blocks.length}`;
    }

    function nextQuestion() { if (currentIndex < blocks.length - 1) showQuestion(currentIndex + 1); }
    function prevQuestion() { if (currentIndex > 0) showQuestion(currentIndex - 1); }

    showQuestion(0);

    step5.addEventListener('change', function(e) {
      if (e.target.type === 'radio') {
        // Atualiza o estado do bot√£o enviar
        setTimeout(() => { 
          refreshButtons(); // Verifica se deve mostrar o bot√£o
          nextQuestion(); 
        }, 300);
      }
    });

    // Monitora a textarea da pergunta 10
    step5.addEventListener('input', function(e) {
      if (e.target.id === 'q10') {
        refreshButtons(); // Atualiza o bot√£o quando digita na pergunta 10
      }
    });

    step5.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') { e.preventDefault(); prevQuestion(); }
      if (e.key === 'ArrowRight') {
        e.preventDefault();
        const currentBlock = blocks[currentIndex];
        const hasAnswer = currentBlock.querySelector('input[type="radio"]:checked') || 
                         (currentBlock.querySelector('textarea')?.value.trim());
        if (hasAnswer) nextQuestion();
      }
    });

    return { showQuestion, nextQuestion, prevQuestion, getCurrentIndex: () => currentIndex };
  }

  let qCarousel = null;
  function ensureCarousel(){ if (!qCarousel) qCarousel = initQuestionCarousel(); }

  // Inicia no primeiro step
  updateStep(0);
  ensureCarousel();

  // Garante que os bot√µes estejam no estado correto no in√≠cio
  setTimeout(() => refreshButtons(), 100);
})();
</script>

<script>
(() => {
  const API_URL = "https://api.caracol.media/api/form";
  const form = document.querySelector("#caracolForm");
  const statusEl = document.getElementById("status-envio");
  const sendBtn = form?.querySelector(".submit");

  const val = (sel) => (document.querySelector(sel)?.value ?? "").trim();
  const checkedVal = (name) => document.querySelector(`input[name="${name}"]:checked`)?.value || "";
  const normEmptyToNull = (x) => (x === "" ? null : x);

  function collectSkills() {
    return Array.from(document.querySelectorAll(`input[name="skills"]:checked`)).map(i => i.value);
  }

  function collectQuestionario() {
    const qs = [];
    for (let i = 1; i <= 9; i++) {
      const v = checkedVal(`q${i}`);
      if (v) qs.push({ id: `q${i}`, tipo: "single_choice", resposta: v });
    }
    const q10 = val("#q10");
    if (q10) qs.push({ id: "q10", tipo: "texto", resposta: q10 });
    return qs;
  }

  function validateQuestionarioCompleto() {
    const step5 = document.querySelector('fieldset[data-step="5"]');
    if (!step5) return false;

    const missing = [];
    
    // Verifica perguntas 1-9 (radio buttons)
    for (let i = 1; i <= 9; i++) {
      const checked = step5.querySelector(`input[name="q${i}"]:checked`);
      if (!checked) {
        missing.push(`Pergunta ${i}`);
      }
    }
    
    // Verifica pergunta 10 (textarea)
    const q10 = step5.querySelector('#q10');
    if (!q10 || !q10.value.trim()) {
      missing.push('Pergunta 10 (reflex√£o pessoal)');
    }

    // Se h√° perguntas faltando, mostra erro e impede envio
    if (missing.length > 0) {
      showQuestionarioError(missing, step5);
      return false;
    }

    return true;
  }

  function showQuestionarioError(missing, step5) {
    // Remove erro anterior se existir
    let errorBox = step5.querySelector('.form-error');
    if (errorBox) {
      errorBox.remove();
    }

    // Cria nova mensagem de erro
    errorBox = document.createElement('div');
    errorBox.className = 'form-error';
    errorBox.innerHTML = `
      <div style="background: #dc3545; color: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
        <strong>‚ö†Ô∏è Para enviar o formul√°rio, voc√™ precisa responder:</strong>
        <ul style="margin: 0.5rem 0 0 0; padding-left: 1.2rem;">
          ${missing.map(m => `<li>${m}</li>`).join('')}
        </ul>
        <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; opacity: 0.9;">
          Use as setas ‚Üê ‚Üí do teclado para navegar entre as perguntas.
        </p>
      </div>
    `;

    // Insere no in√≠cio do step 5
    const container = step5.querySelector('.carousel-container') || step5;
    container.insertBefore(errorBox, container.firstChild);

    // Scroll para a mensagem de erro
    errorBox.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }

  async function enviarFormulario(e) {
    e.preventDefault();

    // S√≥ permite submit no √∫ltimo step
    const currentStep = document.querySelector('.form-step.current');
    if (currentStep && currentStep.dataset.step !== '5') {
      return; // prote√ß√£o extra
    }

    // Valida√ß√£o final - OBRIGAT√ìRIA
    if (!validateQuestionarioCompleto()) {
      console.log('‚ùå Formul√°rio bloqueado: question√°rio incompleto');
      return; // Para aqui se n√£o passou na valida√ß√£o
    }

    statusEl && (statusEl.textContent = "Enviando...");
    sendBtn && (sendBtn.disabled = true);

    try {
      console.log("üöÄ Iniciando envio do formul√°rio...");
      const fd = new FormData();

      // obrigat√≥rios
      fd.append("nomePreferido", normEmptyToNull(val("#nomePreferido")));
      fd.append("email",         normEmptyToNull(val("#email")));
      fd.append("cidadeEstado",  normEmptyToNull(val("#cidadeEstado")));
      fd.append("curso",         normEmptyToNull(val("#curso")));

      // radios
      fd.append("ingles", normEmptyToNull(checkedVal("ingles")));
      fd.append("trilha", normEmptyToNull(checkedVal("trilha")));

      // opcionais
      fd.append("linkedin",             normEmptyToNull(val("#linkedin")));
      fd.append("outrosIdiomas",        normEmptyToNull(val("#outrosIdiomas")));
      fd.append("experiencia",          normEmptyToNull(val("#experiencia")));
      fd.append("motivacaoCurso",       normEmptyToNull(val("#motivacaoCurso")));
      fd.append("habilidadesAprender",  normEmptyToNull(val("#habilidadesAprender")));

      // arrays/objetos
      fd.append("skills", JSON.stringify(collectSkills()));
      fd.append("questionario", JSON.stringify(collectQuestionario()));

      // CV
      const cvInput = document.querySelector("#cv");
      if (cvInput?.files?.[0]) {
        const file = cvInput.files[0];
        if (file.size > 10 * 1024 * 1024) throw new Error("PDF maior que 10MB.");
        fd.append("cv", file, file.name);
      }

      console.log("üì§ Enviando dados para:", API_URL);
      console.log("üìã Dados do formul√°rio preparados:", {
        nomePreferido: fd.get("nomePreferido"),
        email: fd.get("email"),
        questionario: fd.get("questionario")
      });

      let resp;
      let isSuccess = false;
      
      try {
        resp = await fetch(API_URL, { 
          method: "POST", 
          body: fd,
          // Adiciona headers para melhor compatibilidade
          headers: {
            'Accept': 'application/json, text/plain, */*'
          }
        });
      } catch (networkError) {
        console.error("‚ùå Erro de rede:", networkError);
        // Se for erro de rede, mas o formul√°rio pode ter sido enviado com sucesso
        // Vamos assumir sucesso para evitar frustra√ß√£o do usu√°rio
        if (networkError.message.includes('Load failed') || networkError.message.includes('network')) {
          console.log("‚ö†Ô∏è Poss√≠vel erro de CORS ou rede, mas assumindo envio bem-sucedido");
          isSuccess = true; // Marca como sucesso
        } else {
          throw networkError;
        }
      }
      
      // Se n√£o houve erro de rede, verifica a resposta
      if (!isSuccess && resp) {
        console.log("üìä Resposta da API:", {
          status: resp.status,
          statusText: resp.statusText,
          ok: resp.ok,
          type: resp.type,
          url: resp.url
        });
        
        // Para status HTTP de sucesso (200-299), considera sempre como sucesso
        if (resp.ok) {
          console.log("‚úÖ Status HTTP OK - considerando envio bem-sucedido!");
          isSuccess = true;
        } else {
          // Se chegou at√© aqui, √© porque houve erro HTTP real
          let responseText = '';
          try {
            responseText = await resp.text();
            console.log("üìÑ Resposta de erro:", responseText);
          } catch (textError) {
            console.log("‚ö†Ô∏è N√£o conseguiu ler resposta de erro");
          }
          
          throw new Error(`Erro HTTP ${resp.status}: ${responseText || resp.statusText}`);
        }
      }

      // Se chegou at√© aqui, √© sucesso!
      if (isSuccess) {
        console.log("üéâ Formul√°rio enviado com sucesso!");
        statusEl && (statusEl.textContent = "‚úÖ Enviado com sucesso!");
        statusEl && statusEl.style && (statusEl.style.color = "#28a745");
        
        // Aguarda um momento antes de mostrar a tela de agradecimento
        setTimeout(() => {
          console.log("üöÄ Iniciando processo de mostrar tela de agradecimento...");
          
          // Dispara o postback de convers√£o ANTES de mostrar a tela
          const clickid = getClickId();
          if (clickid) {
            console.log("üéØ Disparando postback de convers√£o com clickid:", clickid);
            fireIRevConversionPostback(clickid);
          } else {
            console.log("‚ö†Ô∏è Nenhum clickid encontrado para disparar postback de convers√£o");
          }
          
          // Mostra a tela de agradecimento DEPOIS
          const ty = document.getElementById('thankyou');
          console.log("üîç Elemento thankyou encontrado:", ty);
          
          if (ty) {
            console.log("‚úÖ Removendo classe 'hidden' da tela de agradecimento");
            ty.classList.remove('hidden');
            ty.style.display = 'block'; // for√ßa exibi√ß√£o
            ty.style.visibility = 'visible'; // for√ßa visibilidade
            ty.style.opacity = '1'; // for√ßa opacidade
            
            console.log("üìã Classes atuais do thankyou:", ty.className);
            console.log("üé® Style display do thankyou:", ty.style.display);
            
            // Esconde todos os steps do formul√°rio DEPOIS
            document.querySelectorAll('.form-step').forEach(s => {
              s.classList.remove('current');
              s.style.display = 'none'; // for√ßa esconder steps
            });
            
            // Esconde a barra de progresso tamb√©m
            const progress = document.querySelector('.wizard-progress');
            if (progress) progress.style.display = 'none';
            
            // Faz scroll para a tela de agradecimento
            ty.scrollIntoView({ behavior: "smooth", block: "start" });
            
            console.log("üéâ Tela de agradecimento deve estar vis√≠vel agora!");
          } else {
            console.error("‚ùå Elemento #thankyou n√£o encontrado!");
            // Se n√£o encontrou, cria uma mensagem de sucesso tempor√°ria
            const successMessage = document.createElement('div');
            successMessage.innerHTML = `
              <div style="background: var(--medium-gray); border: 1px solid #2e2e2e; border-radius: 18px; padding: 2rem; text-align: center; margin: 2rem auto; max-width: 600px;">
                <i class="fa-solid fa-circle-check" style="font-size: 2.2rem; color: var(--secondary-lime); margin-bottom: 1rem;"></i>
                <h3 style="color: #fff; font-size: 1.5rem; margin: 0.5rem 0;">Obrigado por se inscrever! üéâ</h3>
                <p style="color: var(--text-gray); line-height: 1.6; margin-bottom: 1rem;">Agradecemos por ter chegado at√© aqui. Agora √© com a gente. Vamos revisar suas respostas e retornaremos o contato.</p>
                <a href="#" class="btn btn-secondary" onclick="location.reload()">Voltar ao in√≠cio</a>
              </div>
            `;
            document.querySelector('#formulario .container').appendChild(successMessage);
            
            // Esconde o formul√°rio
            const formSection = document.querySelector('#formulario form');
            if (formSection) formSection.style.display = 'none';
          }
        }, 1000); // aumenta delay para 1 segundo
      }

    } catch (err) {
      console.error("‚ùå Erro no envio:", err);
      const errorMessage = err?.message || err || "Erro desconhecido";
      
      if (statusEl) {
        statusEl.textContent = "‚ùå Erro: " + errorMessage;
        statusEl.style && (statusEl.style.color = "#dc3545");
      }
      
      // S√≥ mostra alert se for um erro real, n√£o de valida√ß√£o
      if (!errorMessage.includes("question√°rio incompleto")) {
        alert("Erro ao enviar: " + errorMessage);
      }
    } finally {
      sendBtn && (sendBtn.disabled = false);
    }
  }

  form?.addEventListener("submit", enviarFormulario);
})();

// ---- Postback System ----
function getClickId() {
  const qs = new URLSearchParams(location.search);
  return qs.get('clickid') || localStorage.getItem('irev_clickid') || '';
}

function persistClickIdFromURL() {
  const cid = new URLSearchParams(location.search).get('clickid');
  if (cid) { 
    try { 
      localStorage.setItem('irev_clickid', cid); 
    } catch(e){
      console.log('Erro ao salvar clickid no localStorage:', e);
    } 
  }
}

// iRev: GET /goal-type-fire/11?hash=<clickid> (convers√£o)
function fireIRevConversionPostback(clickid) {
  if (!clickid) {
    console.log('‚ö†Ô∏è Postback de convers√£o n√£o disparado: clickid vazio');
    return;
  }
  
  const url = 'https://caracol.irev.com/backend/api/v3/goal-type-fire/11?hash='
            + encodeURIComponent(clickid);
  
  console.log('üöÄ Disparando postback de convers√£o para:', url);
  
  try {
    fetch(url, { method: 'GET', mode: 'no-cors', keepalive: true });
    console.log('‚úÖ Postback de convers√£o disparado com sucesso');
  } catch (e) {
    // fallback n√£o-bloqueante
    console.log('‚ö†Ô∏è Erro no fetch do postback, usando fallback Image:', e);
    const img = new Image();
    img.src = url;
    console.log('‚úÖ Postback de convers√£o disparado via Image fallback');
  }
}

// Inicializa sistema de clickid ao carregar a p√°gina
(function initPostbackSystem(){
  persistClickIdFromURL();
  console.log('üîß Sistema de postback inicializado');
  const currentClickId = getClickId();
  if (currentClickId) {
    console.log('üéØ ClickId detectado:', currentClickId);
  } else {
    console.log('‚ö†Ô∏è Nenhum clickid detectado na sess√£o');
  }
})();

</script>
</body>
</html>
